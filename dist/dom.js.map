{"version":3,"sources":["/Users/lixianjie/project/openSource/utils/src/dom.ts"],"sourcesContent":["import { Bound, TupleNumber } from \"./common-type.js\";\nimport { isDom, isNumber } from \"./is.js\";\nimport { clamp } from \"./number.js\";\n\nconst portalsID = \"J__PORTALS__NODE__\";\n\n/**\n * get a dom, multiple calls will return the same dom\n * @param namespace - create a uniq node by namespace\n * @return - dom\n * */\nexport const getPortalsNode = (namespace?: string): HTMLDivElement => {\n  const id =\n    portalsID + (namespace ? namespace.toLocaleUpperCase() : \"DEFAULT\");\n\n  let portalsEl = document.getElementById(id);\n\n  if (!portalsEl) {\n    const el = document.createElement(\"div\");\n    el.id = id;\n    portalsEl = document.body.appendChild(el);\n  }\n  return portalsEl as HTMLDivElement;\n};\n\n/**\n * get scrollbar width\n * @param className - If the element customizes the scroll bar through css, pass in the class name for customization\n * @return scroll - bar [x, y] width, generally 0 on mobile, unless you customize the scroll bar\n * */\nexport function getScrollBarWidth(className?: string): TupleNumber {\n  // Create the measurement node\n  const scrollEl = document.createElement(\"div\");\n  if (className) scrollEl.className = className;\n  scrollEl.style.overflow = \"scroll\";\n  scrollEl.style.height = \"200px\";\n  scrollEl.style.width = \"200px\";\n  scrollEl.style.border = \"2px solid red\";\n\n  document.body.appendChild(scrollEl);\n\n  let wSize = scrollEl.offsetWidth - scrollEl.clientWidth;\n  let hSize = scrollEl.offsetWidth - scrollEl.clientWidth;\n\n  const sty = getStyle(scrollEl);\n\n  if (sty) {\n    const trimPXStr = (s) => s.replace(/px/, \"\");\n    wSize =\n      wSize - trimPXStr(sty.borderLeftWidth) - trimPXStr(sty.borderRightWidth);\n    hSize =\n      hSize - trimPXStr(sty.borderTopWidth) - trimPXStr(sty.borderBottomWidth);\n  }\n\n  document.body.removeChild(scrollEl);\n\n  // Get the scrollbar width\n  return [wSize, hSize];\n}\n\n/**\n * get style value of dom element\n * @param dom - target dom\n * @return - an object containing all available style values, an null means not supported\n *  */\nexport function getStyle(dom: HTMLElement): Partial<CSSStyleDeclaration> {\n  if (!dom) return {};\n  // @ts-ignore\n  if (!dom.currentStyle && !window.getComputedStyle) return {};\n  // @ts-ignore\n  return dom.currentStyle ? dom.currentStyle : window.getComputedStyle(dom);\n}\n\n/**\n * check if element is visible\n * @param target - an element to be detected or an object that represents location information\n * @param option\n * @param option.fullVisible - false | default is to be completely invisible, and set to true to be invisible if element is partially occluded\n * @param option.wrapEl - By default, the viewport computes visibility through this specified element (viewport is still detected)\n * @param option.offset - Offset of visibility, specifying all directions for numbers, and specific directions for object\n * @return - Whether the overall visibility information and the specified direction does not exceed the visible boundary\n * */\nexport function checkElementVisible(\n  target: HTMLElement | Partial<Bound>,\n  option: {\n    fullVisible?: boolean;\n    wrapEl?: HTMLElement;\n    offset?: number | Partial<Bound>;\n  } = {}\n): {\n  visible: boolean;\n  top: boolean;\n  left: boolean;\n  right: boolean;\n  bottom: boolean;\n  bound: Partial<Bound>;\n} {\n  const { fullVisible = false, wrapEl, offset = 0 } = option;\n\n  const ofs = getOffsetObj(offset);\n\n  // 核心是判定视口的可用区域所在的框，再检测元素是否在这个框坐标内\n\n  /** 基础边界(用于窗口) */\n  const yMinBase = 0;\n  const xMinBase = 0;\n  const yMaxBase = window.innerHeight;\n  const xMaxBase = window.innerWidth;\n\n  /** 有效边界 */\n  let aYMin = yMinBase;\n  let aXMin = xMinBase;\n  let aYMax = yMaxBase;\n  let aXMax = xMaxBase;\n\n  // 需要同时检测是否超出窗口、所在容器\n  if (wrapEl) {\n    const { top, left, bottom, right } = wrapEl.getBoundingClientRect();\n\n    const yMin = yMinBase + top;\n    const xMin = xMinBase + left;\n    const yMax = bottom;\n    const xMax = right; // 减去元素右边到视口右边\n\n    // 有效区域左上取最小值，最小不小于0\n    // 有效区域右下取最大值，最大不大于窗口对应方向尺寸\n    aXMin = clamp(Math.max(xMinBase, xMin), xMinBase, xMaxBase);\n    aYMin = clamp(Math.max(yMinBase, yMin), yMinBase, yMaxBase);\n    aXMax = clamp(Math.min(xMaxBase, xMax), xMinBase, xMaxBase);\n    aYMax = clamp(Math.min(yMaxBase, yMax), yMinBase, yMaxBase);\n  }\n\n  const bound = isDom(target) ? target.getBoundingClientRect() : target;\n\n  const { top, left, bottom, right } = offsetCalc(bound, ofs);\n\n  /** fullVisible检测 */\n  const topPos = fullVisible ? top : bottom;\n  const bottomPos = fullVisible ? bottom : top;\n  const leftPos = fullVisible ? left : right;\n  const rightPos = fullVisible ? right : left;\n\n  // 指定方向是否包含有效尺寸\n  const xFalse = aXMax === aXMin;\n  const yFalse = aYMax === aYMin;\n\n  const topVisible = yFalse ? false : topPos >= aYMin;\n  const leftVisible = xFalse ? false : leftPos >= aXMin;\n  const bottomVisible = yFalse ? false : bottomPos <= aYMax;\n  const rightVisible = xFalse ? false : rightPos <= aXMax;\n\n  return {\n    visible: topVisible && leftVisible && rightVisible && bottomVisible,\n    top: topVisible,\n    left: leftVisible,\n    right: rightVisible,\n    bottom: bottomVisible,\n    bound,\n  };\n}\n\n/** 用于checkElementVisible获取offset四个方向的值 */\nfunction getOffsetObj(offset) {\n  const ofs = { left: 0, top: 0, right: 0, bottom: 0 };\n\n  if (!offset) return ofs;\n\n  if (isNumber(offset)) {\n    return { left: offset, top: offset, right: offset, bottom: offset };\n  }\n\n  Object.keys(ofs).forEach((key) => {\n    if (isNumber(offset[key])) {\n      ofs[key] = offset[key];\n    }\n  });\n\n  return ofs;\n}\n\n/** 用于checkElement，计算offset对象和当前位置对象的最终值 */\nfunction offsetCalc(bound, offset) {\n  return {\n    top: bound.top - offset.top,\n    left: bound.left - offset.left,\n    right: bound.right + offset.right,\n    bottom: bound.bottom + offset.bottom,\n  };\n}\n\ninterface TriggerHighlightConf {\n  /** #1890ff | line color */\n  color: string;\n  /** true | use outline, if false use box-shadow */\n  useOutline: boolean;\n}\n\nexport function triggerHighlight(\n  target: HTMLElement,\n  TriggerHighlightConf?: TriggerHighlightConf\n): void;\nexport function triggerHighlight(\n  selector: string,\n  TriggerHighlightConf?: TriggerHighlightConf\n): void;\nexport function triggerHighlight(\n  t: string | HTMLElement,\n  TriggerHighlightConf?: TriggerHighlightConf\n): void;\nexport function triggerHighlight(t, conf) {\n  if (isDom(t)) {\n    mountHighlight(t, conf);\n  } else {\n    const temp = document.querySelectorAll(t);\n    if (temp.length) {\n      Array.from(temp).forEach((item) => mountHighlight(item, conf));\n    }\n  }\n}\n\nconst mountHighlightDefaultConf = {\n  color: \"#1890ff\",\n  useOutline: true,\n};\n\nfunction mountHighlight(target, conf = {}) {\n  const cf = {\n    ...mountHighlightDefaultConf,\n    ...conf,\n  };\n\n  if (cf.useOutline) {\n    target.style.outline = `1px auto ${cf.color}`;\n  } else {\n    target.style.boxShadow = `0 0 0 4px ${cf.color}`;\n  }\n\n  function clickHandle() {\n    if (cf.useOutline) {\n      target.style.outline = \"\";\n    } else {\n      target.style.boxShadow = \"\";\n    }\n\n    document.removeEventListener(\"click\", clickHandle);\n    document.removeEventListener(\"keydown\", clickHandle);\n  }\n\n  document.addEventListener(\"click\", clickHandle);\n  document.addEventListener(\"keydown\", clickHandle);\n}\n\n/**\n * Query the incoming Node for the presence of a specified node in all of its parent nodes\n * @param node - node to be queried\n * @param matcher - matcher, recursively receives the parent node and returns whether it matches\n * @param depth - maximum query depth\n * */\nexport function getCurrentParent(\n  node: Element,\n  matcher: (node: Element) => boolean,\n  depth?: number\n) {\n  let hasMatch = false;\n\n  let cDepth = 0;\n\n  function recur(n) {\n    if (depth) {\n      cDepth++;\n      if (cDepth === depth) return;\n    }\n\n    if (!n) {\n      return;\n    }\n    const pNode = n.parentNode;\n\n    if (pNode) {\n      const res = matcher(pNode);\n      if (res) {\n        hasMatch = true;\n        return;\n      }\n    }\n\n    recur(pNode);\n  }\n\n  recur(node);\n\n  return hasMatch;\n}\n\n/**\n * get scrolling parent node, get all when pass getAll\n * When setting or getting scrollTop/scrollLeft on document.documentElement and document.body, the performance of different browsers will be inconsistent, so when the scroll element is document.documentElement or document.body, document.documentElement is returned uniformly for easy identification\n * */\nexport function getScrollParent(\n  ele: HTMLElement,\n  getAll?: false\n): HTMLElement | null;\nexport function getScrollParent(\n  ele: HTMLElement,\n  getAll?: boolean\n): HTMLElement | HTMLElement[] | null;\nexport function getScrollParent(ele: HTMLElement, getAll?: boolean): any {\n  let node: any = getAll ? [] : null;\n\n  function handle(el) {\n    const parent = el.parentNode;\n\n    if (parent) {\n      const e = parent;\n      const h = e.clientHeight;\n      const sH = e.scrollHeight;\n\n      if (sH > h) {\n        const isRoot = e === document.documentElement || e === document.body;\n        const scrollStatus = hasScroll(e);\n\n        // 为body或doc时，统一取documentElement方便识别，部分浏览器支持body设置document.scrollXxx部分浏览器支持documentElement设置\n        const element = isRoot ? document.documentElement : e;\n\n        /* body和html元素不需要检测滚动属性 */\n        if (isRoot || scrollStatus.x || scrollStatus.y) {\n          if (getAll) {\n            if (isRoot) {\n              node.indexOf(document.documentElement) === -1 &&\n                node.push(element);\n            } else {\n              node.push(element);\n            }\n          } else {\n            node = element;\n            return;\n          }\n        }\n      }\n\n      handle(e);\n    } else {\n      // 无匹配\n    }\n  }\n\n  handle(ele);\n\n  return node;\n}\n\n/** get doc scroll offset, used to solve the problem of different versions of the browser to get inconsistent */\nexport function getDocScrollOffset() {\n  const doc = document.documentElement;\n  const body = document.body;\n\n  return {\n    // Math.ceil用于解决高分屏缩放时的滚动位置小数问题\n    x: Math.ceil(doc.scrollLeft + body.scrollLeft),\n    y: Math.ceil(doc.scrollTop + body.scrollTop),\n  };\n}\n\n/** set doc scroll offset */\nexport function setDocScrollOffset(conf: { x?: number; y?: number } = {}) {\n  if (isNumber(conf.x)) {\n    // eslint-disable-next-line\n    document.body.scrollLeft = document.documentElement.scrollLeft = conf.x;\n  }\n\n  if (isNumber(conf.y)) {\n    // eslint-disable-next-line\n    document.body.scrollTop = document.documentElement.scrollTop = conf.y;\n  }\n}\n\n/** check whether the dom node is scrollable */\nexport function hasScroll(el: HTMLElement): { x: boolean; y: boolean } {\n  let x = Math.max(0, el.scrollWidth - el.clientWidth) > 0;\n  let y = Math.max(0, el.scrollHeight - el.clientHeight) > 0;\n\n  if (el === document.documentElement || el === document.body) {\n    // ...\n  } else {\n    const { overflowX, overflowY } = getStyle(el);\n    if (overflowX !== \"scroll\" && overflowX !== \"auto\") {\n      x = false;\n    }\n    if (overflowY !== \"scroll\" && overflowY !== \"auto\") {\n      y = false;\n    }\n  }\n\n  return {\n    x,\n    y,\n  };\n}\n"],"names":["isDom","isNumber","clamp","portalsID","getPortalsNode","namespace","id","toLocaleUpperCase","portalsEl","document","getElementById","el","createElement","body","appendChild","getScrollBarWidth","className","scrollEl","style","overflow","height","width","border","wSize","offsetWidth","clientWidth","hSize","sty","getStyle","trimPXStr","s","replace","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","removeChild","dom","currentStyle","window","getComputedStyle","checkElementVisible","target","option","fullVisible","wrapEl","offset","ofs","getOffsetObj","yMinBase","xMinBase","yMaxBase","innerHeight","xMaxBase","innerWidth","aYMin","aXMin","aYMax","aXMax","getBoundingClientRect","top","left","bottom","right","yMin","xMin","yMax","xMax","Math","max","min","bound","offsetCalc","topPos","bottomPos","leftPos","rightPos","xFalse","yFalse","topVisible","leftVisible","bottomVisible","rightVisible","visible","Object","keys","forEach","key","triggerHighlight","t","conf","mountHighlight","temp","querySelectorAll","length","Array","from","item","mountHighlightDefaultConf","color","useOutline","cf","outline","boxShadow","clickHandle","removeEventListener","addEventListener","getCurrentParent","node","matcher","depth","hasMatch","cDepth","recur","n","pNode","parentNode","res","getScrollParent","ele","getAll","handle","parent","e","h","clientHeight","sH","scrollHeight","isRoot","documentElement","scrollStatus","hasScroll","element","x","y","indexOf","push","getDocScrollOffset","doc","ceil","scrollLeft","scrollTop","setDocScrollOffset","scrollWidth","overflowX","overflowY"],"mappings":"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"}