{"version":3,"sources":["/Users/lixianjie/project/openSource/utils/src/date.ts"],"sourcesContent":["import { padSingleNumber } from \"./format.js\";\n\n/**\n * Receive a date string, timestamp (ms), date object, and return it after converting it into a date object, or return null if the conversion fail\n *  */\nexport function parseDate(date: any): Date | null {\n  let d = date;\n  if (typeof date === \"string\") {\n    d = date.replace(/-/g, \"/\"); // Safari无法解析 2020-01-01 格式的日期\n  }\n  d = new Date(d);\n\n  // 处理Invalid Date\n  if (d instanceof Date && isNaN(d.getTime())) {\n    return null;\n  }\n\n  return d;\n}\n\n/**\n * format the date into readable date string\n * @param date - new Date() | any time(string/date object/timestamp .etc) that can be parsed by parseDate(), default current time\n * @param format - 'YYYY-MM-DD hh:mm:ss' | custom format\n * @return - formatted date string, if date is invalid, return an empty string\n * @example\n datetime(); // => 2020-06-01 18:45:57\n datetime('2020-06-01 15:30:30', 'hh时mm分 YYYY年MM月'); // => 15时30分 2020年06月\n datetime(1591008308782, 'YY年MM月DD日'); // => 21年06月01日\n datetime('1591008308782'); // => ''\n datetime('hello'); // => ''\n datetime(new Date()); // => 2020-06-01 18:46:39\n */\nexport function datetime(date = new Date(), format = \"YYYY-MM-DD hh:mm:ss\") {\n  const d = parseDate(date);\n\n  if (!d) {\n    return \"\";\n  }\n\n  const fn = (d) => {\n    return (\"0\" + d).slice(-2);\n  };\n\n  const formats = {\n    YY: String(d.getFullYear() + 1).slice(2),\n    YYYY: d.getFullYear(),\n    MM: fn(d.getMonth() + 1),\n    DD: fn(d.getDate()),\n    hh: fn(d.getHours()),\n    mm: fn(d.getMinutes()),\n    ss: fn(d.getSeconds()),\n  };\n\n  return format.replace(/([a-z])\\1+/gi, (a) => {\n    return formats[a] || a;\n  });\n}\n\nconst oneMS = 100;\nconst oneS = oneMS * 10;\nconst oneM = 60 * oneS;\nconst oneH = 60 * oneM;\nconst oneD = 24 * oneH;\n\n/**\n * get d day, h hour, m minute, s second, ms millisecond between the current time and the specified time. If the current time exceeds the incoming time, all return to '00' and timeOut is true\n * @param date - any time that can be parsed by parseDate()\n * @return count data\n */\nexport function getDateCountDown(date?: any) {\n  const dt = parseDate(date);\n\n  if (!dt) {\n    return {\n      ms: \"00\",\n      s: \"00\",\n      m: \"00\",\n      h: \"00\",\n      d: \"00\",\n      timeOut: true,\n    };\n  }\n\n  const start = Date.now();\n  const end = dt.getTime();\n\n  const diff = end - start;\n\n  if (diff < 0) {\n    return getDateCountDown();\n  }\n\n  const fr = Math.floor;\n\n  // h、m、s 用单位总数取余就是该单位对应的ms，除单位总数获得单位\n  const d = fr(diff / oneD);\n  const h = fr((diff % oneD) / oneH);\n  const m = fr((diff % oneH) / oneM);\n  const s = fr((diff % oneM) / oneS);\n  const ms = fr(diff % oneMS);\n\n  return {\n    d: padSingleNumber(d),\n    h: padSingleNumber(h),\n    m: padSingleNumber(m),\n    s: padSingleNumber(s),\n    ms: padSingleNumber(ms),\n    timeOut: false,\n  };\n}\n\n/**\n * Whether the current time or the specified time is within a certain period of time\n * @param startDate - start time\n * @param endDate - end time\n * @param currentDate - mid time, default is now\n * @return - whether within a time period\n * */\nexport function isBetweenDate(startDate: any, endDate: any, currentDate: any) {\n  const s = parseDate(startDate);\n  const e = parseDate(endDate);\n\n  if (!s || !e) return false;\n\n  if (currentDate) {\n    const c = parseDate(currentDate);\n    if (!c) return false;\n\n    return c <= e && c >= s;\n  }\n\n  const c = new Date();\n\n  return c <= e && c >= s;\n}\n"],"names":["padSingleNumber","parseDate","date","d","replace","Date","isNaN","getTime","datetime","format","fn","slice","formats","YY","String","getFullYear","YYYY","MM","getMonth","DD","getDate","hh","getHours","mm","getMinutes","ss","getSeconds","a","oneMS","oneS","oneM","oneH","oneD","getDateCountDown","dt","ms","s","m","h","timeOut","start","now","end","diff","fr","Math","floor","isBetweenDate","startDate","endDate","currentDate","e","c"],"mappings":"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"}